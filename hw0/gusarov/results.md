##Результаты

Путь до csv в коде указан полный, потому что он почему-то по умолчанию находится не в проекте, а в `/home`

    +---------------+------------------+
    |      room_type|        avg(price)|
    +---------------+------------------+
    |    Shared room| 70.12758620689655|
    |Entire home/apt|211.79424613325986|
    |   Private room| 89.78097285675894|
    +---------------+------------------+

    +---------------+----+
    |      room_type|mode|
    +---------------+----+
    |    Shared room|  35|
    |Entire home/apt| 150|
    |   Private room|  50|
    +---------------+----+

    +---------------+---+
    |      room_type|med|
    +---------------+---+
    |    Shared room| 45|
    |Entire home/apt|160|
    |   Private room| 70|
    +---------------+---+

    +---------------+------------------+
    |      room_type|        dispersion|
    +---------------+------------------+
    |    Shared room|10348.026848353218|
    |Entire home/apt| 80679.63674113646|
    |   Private room| 25665.72608991132|
    +---------------+------------------+
    
    MOST EXPENSIVE OFFER
    +--------+--------------------+-------+---------+-------------------+-------------+--------+---------+---------------+-----+--------------+-----------------+-----------+-----------------+------------------------------+----------------+
    |      id|                name|host_id|host_name|neighbourhood_group|neighbourhood|latitude|longitude|      room_type|price|minimum_nights|number_of_reviews|last_review|reviews_per_month|calculated_host_listings_count|availability_365|
    +--------+--------------------+-------+---------+-------------------+-------------+--------+---------+---------------+-----+--------------+-----------------+-----------+-----------------+------------------------------+----------------+
    |13894339|Luxury 1 bedroom ...|5143901|     Erin|           Brooklyn|   Greenpoint| 40.7326|-73.95739|Entire home/apt|10000|             5|                5| 2017-07-27|             0.16|                             1|               0|
    +--------+--------------------+-------+---------+-------------------+-------------+--------+---------+---------------+-----+--------------+-----------------+-----------+-----------------+------------------------------+----------------+
    only showing top 1 row
    
    CHEAPEST OFFER
    +--------+--------------------+-------+---------+-------------------+------------------+--------+---------+------------+-----+--------------+-----------------+-----------+-----------------+------------------------------+----------------+
    |      id|                name|host_id|host_name|neighbourhood_group|     neighbourhood|latitude|longitude|   room_type|price|minimum_nights|number_of_reviews|last_review|reviews_per_month|calculated_host_listings_count|availability_365|
    +--------+--------------------+-------+---------+-------------------+------------------+--------+---------+------------+-----+--------------+-----------------+-----------+-----------------+------------------------------+----------------+
    |18750597|Huge Brooklyn Bro...|8993084| Kimberly|           Brooklyn|Bedford-Stuyvesant|40.69023|-73.95428|Private room|    0|             4|                1| 2018-01-06|             0.05|                             4|              28|
    +--------+--------------------+-------+---------+-------------------+------------------+--------+---------+------------+-----+--------------+-----------------+-----------+-----------------+------------------------------+----------------+
    only showing top 1 row

    res8: Double = 0.04279933414330361
    
    
    res9: Double = -0.04795422658266245


    geohash_udf: org.apache.spark.sql.expressions.UserDefinedFunction = SparkUserDefinedFunction(<function>,StringType,List(Some(class[value[0]: double]), Some(class[value[0]: double]), Some(class[value[0]: int])),None,true,true)
    +-------+----------+
    |geohash|avg(price)|
    +-------+----------+
    |  dr5wf|     350.0|
    +-------+----------+
    only showing top 1 row